<div id="interview_show_wrapper" 
  data-identifier=<%= @interview.identifier %>
  data-interviewid=<%= @interview.id %>
  data-candidateid=<%= @interview.candidate.id %>
>
  <% if current_user %>
  <div id="interview_sidebar">

    <div id="interview_sidebar_challenge_identifier">
      <h3>Interview Code</h3>
      <p id="interview_identifier"><%= @interview.identifier %></p>
      <p><small>give this code to the candidate</small></p>
    </div>

    <div id="interview_sidebar_conadidate">
      <h3><%= @interview.candidate.name %></h3>

      <div class="candidate_section">
        <h4>Challenges Attempted</h4>
        <% if @interview.candidate.attempted_challenges.any? %>
          <% @interview.candidate.attempted_challenges.each do |ac| %>
            <p><%= ac.title %></p>
          <% end %>
        <% else %>
          <p>no challenges attempted</p>
        <% end %>
      </div>

      <h4>Topics Covered</h4>
      <% if @interview.candidate.addressed_topics.any? %>
        <% @interview.candidate.addressed_topics.each do |at| %>
          <p><%= at.name %></p>
        <% end %>
      <% else %>
        <p>no topics covered</p>
      <% end %>
    </div>

    <div id="interview_sidebar_challenges">
      <h3>Challenges</h3>

      <h4><%= current_user.company.name.capitalize %></h4>
        <% current_user.company.challenges.each do |ch| %>
          <span data-challengeid="<%= ch.id %>" class="clickable"><%= ch.title %></span>
        <% end %>
      <h4>Public</h4>
        <% Challenge.where("public = true").each do |ch| %>
          <span data-challengeid="<%= ch.id %>" class="clickable"><%= ch.title %></span>
        <% end %>
    </div>

    <div id="interview_sidebar_end_challenge">
      End Interview
    </div>


  </div>
  <% end %>

  <div id ="interview_challenge_wrapper">

    <div id="interview_editor_wrapper">
    
      <h1 class="challenge_title">Challenge</h1>

      <div class="code" id="code"></div>

      <div id="interview_editor_buttons_wrapper">
        
        <%= render "select_theme" %>

        <a href="#" id="run_code">Run!</a>
      </div>
    </div>

    <div id="interview_info_wrapper" class="right">

      <div>
        <h3>Challenge Description</h3>
        <div id="interview_challenge_description" class="challenge_description_div_with_bottom_margin">
          After a challenge is chosen, its description will be displayed.
        </div>
      </div>

      <div>
        <h3>Make These Tests Pass</h3>
        <div id="interview_test_code" class="challenge_description_div_with_bottom_margin">
          The test code will appear here.
        </div>
      </div>

      <div>
        <h3>Results</h3>
        <div id="code_results"></div>
      </div>
    </div>

  </div>

  <div id="interview_video_wrapper">

    <div id="remote_video" class="remote_video_wrapper left">
    </div> 

    <div class="local_video_wrapper right">
      <video id="local_video"></video>
    <div>

  </div>
</div>

<script>
        // grab the room from the URL
        var room = $('#interview_show_wrapper').data().identifier                 

        // create our webrtc connection
        var webrtc = new SimpleWebRTC({
            // the id/element dom element that will hold "our" video
            localVideoEl: 'local_video',
            // the id/element dom element that will hold remote videos
            remoteVideosEl: 'remote_video',
            // immediately ask for camera access
            autoRequestMedia: true,
            log: true
        });

      // when it's ready, join if we got a room from the URL
      webrtc.on('readyToCall', function () {
          // you can name it anything
          if (room) webrtc.joinRoom(room);
      });
      
    </script>
